try{"undefined"===typeof WeakMap&&function(){var k=Object.defineProperty,B=Date.now()%1E9,a=function(){this.name="__st"+(1E9*Math.random()>>>0)+(B++ +"__")};a.prototype={set:function(a,e){var b=a[this.name];b&&b[0]===a?b[1]=e:k(a,this.name,{value:[a,e],writable:!0})},get:function(a){var e;return(e=a[this.name])&&e[0]===a?e[1]:void 0}};window.WeakMap=a}()}catch(e$$12){};try{(function(k){function B(){u=!1;var c=p;p=[];c.sort(function(a,c){return a.uid_-c.uid_});var d=!1;c.forEach(function(c){var f=c.takeRecords();a(c);f.length&&(c.callback_(f,c),d=!0)});d&&B()}function a(a){a.nodes_.forEach(function(c){(c=f.get(c))&&c.forEach(function(c){c.observer===a&&c.removeTransientObservers()})})}function h(a,c){for(var d=a;d;d=d.parentNode){var b=f.get(d);if(b)for(var g=0;g<b.length;g++){var m=b[g],q=m.options;(d===a||q.subtree)&&(q=c(q))&&m.enqueue(q)}}}function e(a){this.callback_=
a;this.nodes_=[];this.records_=[];this.uid_=++r}function b(a,c){this.type=a;this.target=c;this.addedNodes=[];this.removedNodes=[];this.oldValue=this.attributeNamespace=this.attributeName=this.nextSibling=this.previousSibling=null}function c(a,c){return t=new b(a,c)}function d(a){if(w)return w;var c=t,d=new b(c.type,c.target);d.addedNodes=c.addedNodes.slice();d.removedNodes=c.removedNodes.slice();d.previousSibling=c.previousSibling;d.nextSibling=c.nextSibling;d.attributeName=c.attributeName;d.attributeNamespace=
c.attributeNamespace;d.oldValue=c.oldValue;w=d;w.oldValue=a;return w}function g(a,c,d){this.observer=a;this.target=c;this.options=d;this.transientObservedNodes=[]}var f=new WeakMap,m=window.msSetImmediate;if(!m){var q=[],l=String(Math.random());window.addEventListener("message",function(a){a.data===l&&(a=q,q=[],a.forEach(function(a){a()}))});m=function(a){q.push(a);window.postMessage(l,"*")}}var u=!1,p=[],r=0;e.prototype={observe:function(a,c){a=window.ShadowDOMPolyfill&&window.ShadowDOMPolyfill.wrapIfNeeded(a)||
a;if(!c.childList&&!c.attributes&&!c.characterData||c.attributeOldValue&&!c.attributes||c.attributeFilter&&c.attributeFilter.length&&!c.attributes||c.characterDataOldValue&&!c.characterData)throw new SyntaxError;var d=f.get(a);d||f.set(a,d=[]);for(var b,m=0;m<d.length;m++)if(d[m].observer===this){b=d[m];b.removeListeners();b.options=c;break}b||(b=new g(this,a,c),d.push(b),this.nodes_.push(a));b.addListeners()},disconnect:function(){this.nodes_.forEach(function(a){a=f.get(a);for(var c=0;c<a.length;c++){var d=
a[c];if(d.observer===this){d.removeListeners();a.splice(c,1);break}}},this);this.records_=[]},takeRecords:function(){var a=this.records_;this.records_=[];return a}};var t,w;g.prototype={enqueue:function(a){var c=this.observer.records_,d=c.length;if(0<c.length){var b=c[d-1];b=b===a?b:!w||b!==w&&b!==t?null:w;if(b){c[d-1]=b;return}}else p.push(this.observer),u||(u=!0,m(B));c[d]=a},addListeners:function(){this.addListeners_(this.target)},addListeners_:function(a){var c=this.options;c.attributes&&a.addEventListener("DOMAttrModified",
this,!0);c.characterData&&a.addEventListener("DOMCharacterDataModified",this,!0);c.childList&&a.addEventListener("DOMNodeInserted",this,!0);(c.childList||c.subtree)&&a.addEventListener("DOMNodeRemoved",this,!0)},removeListeners:function(){this.removeListeners_(this.target)},removeListeners_:function(a){var c=this.options;c.attributes&&a.removeEventListener("DOMAttrModified",this,!0);c.characterData&&a.removeEventListener("DOMCharacterDataModified",this,!0);c.childList&&a.removeEventListener("DOMNodeInserted",
this,!0);(c.childList||c.subtree)&&a.removeEventListener("DOMNodeRemoved",this,!0)},addTransientObserver:function(a){if(a!==this.target){this.addListeners_(a);this.transientObservedNodes.push(a);var c=f.get(a);c||f.set(a,c=[]);c.push(this)}},removeTransientObservers:function(){var a=this.transientObservedNodes;this.transientObservedNodes=[];a.forEach(function(a){this.removeListeners_(a);a=f.get(a);for(var c=0;c<a.length;c++)if(a[c]===this){a.splice(c,1);break}},this)},handleEvent:function(a){switch(a.type){case "DOMAttrModified":var b=
a.attrName,f=a.relatedNode.namespaceURI,g=a.target,m=new c("attributes",g);m.attributeName=b;m.attributeNamespace=f;var q=a.attrChange===MutationEvent.ADDITION?null:a.prevValue;h(g,function(a){if(a.attributes&&(!a.attributeFilter||!a.attributeFilter.length||-1!==a.attributeFilter.indexOf(b)||-1!==a.attributeFilter.indexOf(f)))return a.attributeOldValue?d(q):m});break;case "DOMCharacterDataModified":g=a.target;m=c("characterData",g);q=a.prevValue;h(g,function(a){if(a.characterData)return a.characterDataOldValue?
d(q):m});break;case "DOMNodeRemoved":this.addTransientObserver(a.target);case "DOMNodeInserted":var g=a.relatedNode,e=a.target,l;"DOMNodeInserted"===a.type?(a=[e],l=[]):(a=[],l=[e]);var u=e.previousSibling,e=e.nextSibling,m=c("childList",g);m.addedNodes=a;m.removedNodes=l;m.previousSibling=u;m.nextSibling=e;h(g,function(a){if(a.childList)return m})}t=w=void 0}};k.JsMutationObserver=e;!k.MutationObserver&&k.WebKitMutationObserver&&(k.MutationObserver=k.WebKitMutationObserver);k.MutationObserver||(k.MutationObserver=
e)})(this)}catch(e$$15){};(function(){var k;(function(a){a.EVENT_MUT_INSERT=2;a.EVENT_MUT_REMOVE=3;a.EVENT_MUT_ATTR=4;a.EVENT_MUT_ATTR_CURVE=5;a.EVENT_MUT_TEXT=6;a.EVENT_MUT_SKIPIDS=7;a.EVENT_MOUSEMOVE=8;a.EVENT_MOUSEMOVE_CURVE=9;a.EVENT_SCROLL=10;a.EVENT_SCROLL_CURVE=11;a.EVENT_MOUSEDOWN=12;a.EVENT_MOUSEUP=13;a.EVENT_KEYDOWN=14;a.EVENT_KEYUP=15;a.EVENT_CLICK=16;a.EVENT_FOCUS=17;a.EVENT_VALUECHANGE=18;a.EVENT_RESIZE=19;a.EVENT_DOMLOADED=20;a.EVENT_LOAD=21;a.EVENT_PLACEHOLDER_SIZE=22;a.EVENT_UNLOAD=23;a.EVENT_BLUR=24;a.EVENT_SET_FRAME_BASE=
25;a.EVENT_TOUCHSTART=32;a.EVENT_TOUCHEND=33;a.EVENT_TOUCHCANCEL=34;a.EVENT_TOUCHMOVE=35;a.EVENT_TOUCHMOVE_CURVE=36;a.EVENT_NAVIGATE=37;a.EVENT_PLAY=38;a.EVENT_PAUSE=39;a.EVENT_INNERWIDTH=40;a.EVENT_INNERWIDTH_CURVE=41;a.EVENT_LOG=48;a.EVENT_ERROR=49;a.EVENT_DBL_CLICK=50;a.EVENT_FORM_SUBMIT=51;a.EVENT_WINDOW_FOCUS=52;a.EVENT_WINDOW_BLUR=53;a.EVENT_HEARTBEAT=54;a.EVENT_SYS_SETMETA=8192;a.EVENT_SYS_SETVAR=8193;a.EVENT_SYS_HIGHLIGHT=8194;a.EVENT_COOKED_LOAD="load";a.EVENT_COOKED_UNLOAD="unload";a.EVENT_COOKED_NAVIGATE=
"navigate";a.EVENT_COOKED_CLICK="click";a.EVENT_COOKED_TAP="tap";a.EVENT_COOKED_FOCUS="focus";a.EVENT_COOKED_CHANGE="change";a.EVENT_COOKED_MOUSE_THRASH="thrash";a.isUserActionEvent=function(h){switch(h){case a.EVENT_MOUSEDOWN:case a.EVENT_MOUSEMOVE:case a.EVENT_MOUSEMOVE_CURVE:case a.EVENT_MOUSEUP:case a.EVENT_KEYDOWN:case a.EVENT_KEYUP:case a.EVENT_TOUCHSTART:case a.EVENT_TOUCHEND:case a.EVENT_TOUCHMOVE:case a.EVENT_TOUCHMOVE_CURVE:case a.EVENT_TOUCHCANCEL:case a.EVENT_CLICK:case a.EVENT_SCROLL:case a.EVENT_SCROLL_CURVE:case a.EVENT_NAVIGATE:return!0}return!1};
a.MAX_LOGS_PER_PAGE=1024})(k||(k={}));(function(a){var h;a.$entry=function(a){return a&&a.apply?function(){try{return a.apply(this,arguments)}catch(b){}}:a};a.logIfDebug=function(e){a.isDebug()&&window.console&&console.log(e)};a.logFSError=function(a){};a.stringify=function(a){var b=Array.prototype.toJSON,c=String.prototype.toJSON;try{return h||(h=window.JSON),b&&delete Array.prototype.toJSON,c&&delete String.prototype.toJSON,void 0===a?'"undefined"':a&&a.constructor==Date?isNaN(a)?'"Invalid Date"':
'"'+a.toUTCString()+'"':h.stringify(a)}catch(d){a="Internal error: unable to determine what JSON error was";try{a=""+d,a=a.replace(/[^a-zA-Z0-9\.\:\!\, ]/g,"_")}catch(g){}return'"'+a+'"'}finally{b&&(Array.prototype.toJSON=b),c&&(String.prototype.toJSON=c)}};a.parseJson=function(a){h||(h=window.JSON);return h.parse(a)}})(k||(k={}));(function(a){var h=function(){function a(c,d){this.parent=c;this.combinator=d;this.classes={};this.attrs={};this.attrMatch={}}a.prototype.cssEscapeIdent=function(a){var d=
function(a){return-1!="[]:./\\()@#%^&*'\" ".indexOf(a)?"\\"+a:"\\"+a.charCodeAt(0).toString(16)+" "};return"-"==a?"\\-":"-"==a[0]?"-"+a.slice(1).replace(/([^0-9a-zA-Z-_])/g,d):a.replace(/[^0-9a-zA-Z-_]/g,d)};a.prototype.cssEscapeString=function(a){return'"'+a.replace(/[\x01-\x1f\"\\]/g,function(a){return'"'==a||"\\"==a?"\\"+a:"\\"+a.charCodeAt(0).toString(16)+" "})+'"'};a.prototype.serialize=function(){var a=this.combinator?this.combinator:"";this.tag&&(a+="*"==this.tag?this.tag:this.cssEscapeIdent(this.tag));
this.id&&(a+="#"+this.cssEscapeIdent(this.id));var d=Object.keys(this.classes);d.sort();for(var b=0;b<d.length;b++)a+="."+this.cssEscapeIdent(d[b]);for(var f in this.attrs)a+="["+this.cssEscapeIdent(f)+this.attrMatch[f]+this.cssEscapeString(this.attrs[f])+"]";return a};return a}();a.SelectorRule=h;var e=function(){function a(c){this.rules=c}a.parse=function(c,d){void 0===d&&(d=null);c=c.trim();var g=new h(null,null),f=0,m=!1,q=function(){throw"Invalid selector";},l=function(){s=c[++f];if("\n"==s||
null==s)throw q();if(s.match(/[0-9a-fA-F]/)){var a="";do a+=s,s=c[++f];while(s&&s.match(/[0-9a-fA-F]/));s&&s.match(/[\s]/)&&f++;return String.fromCharCode(parseInt(a,16))}f++;return s},e=function(){for(var a=f,d="",b;null!=(b=c[f]);)if("\\"==b)d+=l();else if(b.match(/[a-zA-Z0-9_\-]/)||128<b.charCodeAt(0))d+=b,f++;else break;if(a==f)throw q();return d},p=function(){for(;null!=c[f]&&c[f].match(/\s/);)f++},k=function(){m=!0;f++;var a=e().toLowerCase(),b;p();b=c[f];var h="=";if("*"==b||"|"==b||"^"==b||
"$"==b||"~"==b)h=b+"=",f++;if(d&&!d[h])throw q();if("="!=c[f])throw q();f++;p();b=h;s=c[f];'"'==s||"'"==s?(h=s,f++):h="]";for(var t="";(s=c[f])!=h;){if(null==s)throw q();if("\\"==s)t+=l();else{if("]"==h&&('"'==s||"'"==s))throw q();t+=s;f++}}f++;"]"!=h&&"]"==c[f]&&f++;g.attrs[a]=t;g.attrMatch[a]=b},t=function(){if(!m)throw q();m=!1;p();var a=c[f];">"==a||"+"==a||"~"==a?(f++,p()):a=" ";g=new h(g,a);if(d&&!d[a])throw q();};if(0==c.indexOf("//"))throw q();for(var w=0,f=0;f<c.length;){if(w++>2*c.length)throw console.log("Likely caught in an infinite loop while parsing "+
c),"Internal error, infinite loop";var s=c[f];switch(s){case "#":m=!0;f++;g.id=e();break;case "*":if(m)throw q();m=!0;g.tag="*";if(d&&!d["*"])throw q();f++;break;case ".":m=!0;f++;g.classes[e()]=!0;break;case "[":k();break;case " ":case ">":case "+":case "~":t();break;case ":":throw q();default:if(m)throw q();m=!0;g.tag=e().toLowerCase()}}if(!m)throw q();return new a(g)};a.prototype.serialize=function(){for(var a=null,d=this.rules;d;d=d.parent)a=a?d.serialize()+a:d.serialize();return a};return a}();
a.Selector=e})(k||(k={}));(function(a){function h(a){var c={};if(!a)return c;if(a.classList)for(var b=0;b<a.classList.length;++b)c[a.classList[b]]=!0;else if(a.className)for(a=(null!=a.className.animVal?a.className.animVal:a.className).split(" "),b=0;b<a.length;++b)c[a[b].trim()]=!0;return c}a.NYI_KIND="nyi";a.BLOCKED_KIND="blocked";a.HIDE_KIND="hide";var e=function(){function a(c,b){this._parent=c;this._rule=b}a.prototype.parent=function(){return this._parent};a.prototype.matches=function(a,c){if(!a||
this._rule.tag&&a.tagName.toLowerCase()!=this._rule.tag||this._rule.id&&a.id!=this._rule.id)return!1;for(var b in this._rule.classes)if(!(b in c))return!1;for(var d in this._rule.attrs)if(a.getAttribute(d)!=this._rule.attrs[d])return!1;return this._parent?this._parent.matches(a.parentElement,h(a.parentElement)):!0};return a}();a.BlockRuleElem=e;var b=function(){function c(b){this.kind=b.Kind;this.selector=a.Selector.parse(b.Selector,{"=":!0,">":!0});var d=function(a){return new e(a.parent?d(a.parent):
null,a)};this.rules=d(this.selector.rules)}c.isComment=function(a){return!!a.match(/^\s*\/\//)};c.prototype.serialize=function(){return this.selector.serialize()};return c}();a.BlockRule=b;var c=function(){function a(){this._rules=[];this.rawRules=[]}a.prototype.isBlocked=function(a){for(var c=h(a),b=0;b<this._rules.length;++b)if(this._rules[b].rules.matches(a,c))return this._rules[b].kind;return null};a.prototype.addRule=function(a){this._rules.push(new b(a));this.rawRules.push(a)};a.prototype.mungeBlockedStyle=
function(a,c){var b=a.getBoundingClientRect(),d=Math.floor(b.width),b=Math.floor(b.height);if("object"==a.tagName.toLowerCase())for(var l=a.children,e=0;e<l.length;e++){var h=l[e];if("embed"==h.tagName.toLowerCase()){l=h.getBoundingClientRect();d=Math.max(d,Math.floor(l.width));b=Math.max(b,Math.floor(l.height));break}}l="";null!=c&&(l=c.trim());0<l.length&&";"!=l.charAt(l.length-1)&&(l+=";");if(0!=d||0!=b)l+="width:"+d+"px;height:"+b+"px;";return l};return a}();a.Blocker=c})(k||(k={}));(function(a){a.Node_ELEMENT_NODE=
1;a.Node_ATTRIBUTE_NODE=2;a.Node_TEXT_NODE=3;a.Node_CDATA_SECTION_NODE=4;a.Node_ENTITY_REFERENCE_NODE=5;a.Node_ENTITY_NODE=6;a.Node_PROCESSING_INSTRUCTION_NODE=7;a.Node_COMMENT_NODE=8;a.Node_DOCUMENT_NODE=9;a.Node_DOCUMENT_TYPE_NODE=10;a.Node_DOCUMENT_FRAGMENT_NODE=11;a.Node_NOTATION_NODE=12;a.XHR_UNSENT=0;a.XHR_OPENED=1;a.XHR_HEADERS_RECEIVED=2;a.XHR_LOADING=3;a.XHR_DONE=4})(k||(k={}));(function(a){function h(a){return"_fsblocked"in a}function e(a,c){a._fsblocked=c}function b(a){return a?a._fs:null}
function c(a){return(a=b(a))?a.id:0}function d(a,c){if(a.attributes&&0<a.attributes.length)for(var b=0;b<a.attributes.length;b++){var d=a.attributes[b];c(d.name,d.value)}}a.isBlocked=h;a.blockKind=function(a){return a._fsblocked};a.setBlocked=e;a.mirrorFor=b;a.fsid=c;a.fsidIfNotBlocked=function(a){return h(a)?0:c(a)};var g=function(){function c(a,b){this._ctx=a;this._blocker=b;this._curId=1}c.prototype.curId=function(){return this._curId};c.prototype.tokenizeNode=function(a,c,d,g){var f=this._curId;
try{var e=[],h=this.tokeNode(d,e,g);if(h&&a){var k=b(a),s=b(c);h.parent=k;s==k.child&&(k.child=h);h.next=s;null==s?(h.prev=k.lastChild,k.lastChild=h):h.prev=s.prev;null!=h.prev&&(h.prev.next=h);null!=h.next&&(h.next.prev=h)}return e}catch(A){return this._curId=f,[]}};c.prototype.removeMirror=function(a){a.parent.child==a&&(a.parent.child=a.next);a.parent.lastChild==a&&(a.parent.lastChild=a.prev);a.prev&&(a.prev.next=a.next);a.next&&(a.next.prev=a.prev);a.id=0;a.child&&this.clearIds(a.child)};c.prototype.clearIds=
function(a){a.id=0;a.next&&this.clearIds(a.next);a.child&&this.clearIds(a.child)};c.prototype.tokeNode=function(c,b,g){if("SCRIPT"==c.nodeName||c.nodeType==a.Node_COMMENT_NODE)return null;var f={id:this._curId++,node:c};c._fs=f;var e=c.nodeName;"http://www.w3.org/2000/svg"==c.namespaceURI&&(e="svg:"+e);b.push("<"+e);try{if(this.processBlockedElem(c,b))return f;g&&g(c);d(c,function(a,c){b.push(":"+a);b.push(c)});if(c.firstChild){b.push("[");for(var e=null,h=c.firstChild;h;h=h.nextSibling){var k=this.tokeNode(h,
b,g);k&&(k.parent=f,e?(e.next=k,k.prev=e):f.child=k,e=f.lastChild=k)}b.push("]")}c.nodeType==a.Node_TEXT_NODE&&b.push(c.textContent)}catch(w){}return f};c.prototype.processBlockedElem=function(c,b){var g=this;if(c.nodeType==a.Node_ELEMENT_NODE&&this._blocker){var f=this._blocker.isBlocked(c);if(f){e(c,f);var h,k=!1;d(c,function(a,d){if("class"==a)d+=" _fs_block_"+f,h=!0;else if("style"==a)d=g._blocker.mungeBlockedStyle(c,d),k=!0;else if("value"==a||"checked"==a||"src"==a)return;b.push(":"+a);b.push(d)});
h||(b.push(":class"),b.push("_fs_block_"+f));k||(b.push(":style"),b.push(this._blocker.mungeBlockedStyle(c,"")));return!0}}return!1};return c}();a.NodeEncoder=g})(k||(k={}));(function(a){function h(a,c){var b=Object.getOwnPropertyDescriptor(a.prototype,c);Object.defineProperty(a.prototype,c,{set:function(a){var c=this;setTimeout(function(){d(c)},0);return b.set.call(this,a)},get:function(){return b.get.call(this)}})}function e(a){switch(a.type){case "checkbox":case "radio":return""+a.checked;default:return(a=
a.value)||(a=""),""+a}}var b=function(){function b(c,g){var q=this;this._onchange=c;this._checkElem=g;this._fallback=!1;this._elems={};this._values={};d=function(c){var b=a.fsid(c);if(b&&(c=q._elems[b])){var d=e(c);d!=q._values[b]&&(q._onchange(c),q._values[b]=d)}}}b.prototype.hookEvents=function(){var a;(a=Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"value"))&&a.set?(c||(h(HTMLInputElement,"value"),h(HTMLInputElement,"checked"),h(HTMLSelectElement,"value"),h(HTMLTextAreaElement,"value"),
c=!0),a=!0):a=!1;a||(this._fallback=!0)};b.prototype.addInput=function(c){var b=a.fsid(c);this._elems[b]=c;this._values[b]=e(c);this._values[b]&&this._onchange(c)};b.prototype.invokeGlobalOnChange=function(a){d(a)};b.prototype.tick=function(){if(this._fallback)for(var a in this._elems)if(this._checkElem(this._elems[a])){var c=this._elems[a],b=e(c);b!=this._values[a]&&(this._onchange(c),this._values[a]=b)}else delete this._elems[a],delete this._values[a]};b.prototype._usingFallback=function(){return this._fallback};
b.prototype._trackingElem=function(a){return!!this._elems[a]};return b}();a.InputWatcher=b;var c=!1,d;a.valueOfInputishElem=e})(k||(k={}));(function(a){var h=function(){function a(){this.dict={idx:-1,map:{}};this.startIdx=0}a.prototype.encode=function(a){function c(){g?1<e.length?f.push([g.idx,e.length]):f.push(g.idx):f.push(e[0])}if(0==a.length)return[];for(var d=a[0],g=Object.prototype.hasOwnProperty.call(this.dict.map,d)?this.dict.map[d]:null,f=[],m,e=[d],d=1;d<a.length;d++)if(m=a[d],g&&Object.prototype.hasOwnProperty.call(g.map,
m))e.push(m),g=g.map[m];else{c();var h=this.startIdx+d-e.length;null==g&&(g={idx:h,map:{}},this.dict.map[e[e.length-1]]=g);g.map[m]={idx:h,map:{}};e=[m];g=Object.prototype.hasOwnProperty.call(this.dict.map,m)?this.dict.map[m]:null}c();this.startIdx+=a.length;return f};return a}();a.LZJGWEncoder=h;h=function(){function a(){this._seq=[]}a.prototype.sequence=function(){return this._seq};a.prototype.decode=function(a){for(var c=this._seq.length,d=0;d<a.length;++d){var g=a[d];switch(typeof g){case "string":this._seq.push(g);
break;case "number":this._seq.push(this._seq[g]);break;case "object":for(var f=0;f<g[1];f++)this._seq.push(this._seq[g[0]+f])}}return c};return a}();a.LZJGWDecoder=h})(k||(k={}));(function(a){a.MutationProcessingInterval=250;a.CurveSamplingInterval=142;a.UploadInterval=5E3;a.UserInactivityTimeout=1E4;a.HeartbeatInitial=4E3;a.HeartbeatMax=256E3;a.PageInactivityTimeout=18E5;a.BackoffMax=3E5;a.ScrollSampleInterval=a.MutationProcessingInterval/5})(k||(k={}));(function(a){var h=function(){function a(c){this._interval=
c;this._handle=-1}a.prototype.oneShot=function(a){setTimeout(a,this._interval)};a.prototype.start=function(a){-1==this._handle&&(this._handle=setInterval(a,this._interval))};a.prototype.stop=function(){-1!=this._handle&&(clearInterval(this._handle),this._handle=-1)};return a}(),e=function(){function b(c,b,g,f,m){void 0===f&&(f=function(){});void 0===m&&(m=h);this._ctx=c;this._processor=b;this._mutProvider=g;this._beforeProcessEvents=f;this._tickerFactory=m;this._eventQueue=[];this._outgoingEventQueue=
[];this._bundleQueue=[];this._host="";this._recordingDisabled=!1;this._backoffTime=this._backoffRetries=0;this._bundleSeq=1;this._lastWhenTime=this._lastPostTime=0;this._lastWhen=-1;this._lastUserAction=0;this._quiescent=!1;this._lastHeartbeat=0;this._heartbeatInterval=a.HeartbeatInitial;this._gotUnload=!1;this._lastBundleTime=c.wallTime();this._sampleCurvesTicker=this.createTicker(a.CurveSamplingInterval);this._processMutationsTicker=this.createTicker(a.MutationProcessingInterval);this._uploadTicker=
this.createTicker(a.UploadInterval)}b.prototype.createTicker=function(a){return new this._tickerFactory(a)};b.prototype.exponentialBackoffMs=function(c,b){var g=Math.min(a.BackoffMax,5E3*Math.pow(2,c));return b?g+0.25*Math.random()*g:g};b.prototype.isErrorFatal=function(a){return 400<=a||202==a?!0:!1};b.prototype.rawQueue=function(){return this._eventQueue};b.prototype.setHost=function(a){this._host=a};b.prototype.startPipeline=function(){var a=this;this._recordingDisabled||this._pipelineStarted||
(this._lastUserAction=this._ctx.now(),this.processEvents(),this._processMutationsTicker.start(function(){a.processEvents()}),this._sampleCurvesTicker.start(function(){a.processEvents(!0)}),this._ctx.amInsideIFrame()||(this.enqueueAndSendBundle(),this._uploadTicker.start(function(){a.enqueueAndSendBundle()})),this._pipelineStarted=!0)};b.prototype.enqueue=function(a,b){this.enqueueAt(this._ctx.now(),a,b)};b.prototype.enqueueAt=function(c,b,g){this._recordingDisabled||(c<=this._lastWhen&&(c=this._lastWhen+
1),this._lastWhen=c,this._eventQueue.push({When:c,Kind:b,Args:g}),a.isUserActionEvent(b)&&(this._lastUserAction=c))};b.prototype.disableRecording=function(){this._recordingDisabled=!0;this.stopPipeline();a.disableConsole()};b.prototype.addUnload=function(){this._gotUnload||(this._gotUnload=!0,this.enqueue(a.EVENT_UNLOAD,[]),this.swanSong())};b.prototype.shutdown=function(){this._flush();this.addUnload();this._flush();this.disableRecording()};b.prototype._flush=function(){this.processEvents();this.maybeSendNextBundle()};
b.prototype.prequeue=function(a,b){this._recordingDisabled||this._eventQueue.unshift({When:0,Kind:a,Args:b})};b.prototype.appendToOutgoingQueue=function(a){this._outgoingEventQueue=this._outgoingEventQueue.concat(a)};b.prototype.appendToQueue=function(a){this._eventQueue=this._eventQueue.concat(a)};b.prototype.lastSentEventTime=function(){return this._lastWhenTime};b.prototype.swanSong=function(){if(!this._recordingDisabled&&!this._ctx.amInsideIFrame()&&(this.processEvents(),0<this._outgoingEventQueue.length&&
this.enqueueNextBundle(),0<this._bundleQueue.length||this._pendingBundle)){var c=this._bundleQueue.concat();this._pendingBundle&&c.unshift(this._pendingBundle);a.logIfDebug("Saving "+c.length+" bundles in swan-song.");c={OrgId:this._ctx.orgId(),UserId:this._ctx.userId(),SessionId:this._ctx.sessionId(),PageId:this._ctx.pageId(),Bundles:c,PageStartTime:this._ctx.startTime(),LastBundleTime:this._lastBundleTime};try{localStorage.swanSong=a.stringify(c)}catch(b){}}};b.prototype.recoverSwanSong=function(){if(!this._ctx.amInsideIFrame())try{if("swanSong"in
localStorage){var c=localStorage.swanSong;delete localStorage.swanSong;var b=a.parseJson(c);b.Bundles&&b.UserId&&b.SessionId&&b.PageId?(b.OrgId||(b.OrgId=this._ctx.orgId()),0<b.Bundles.length&&(a.logIfDebug("Sending "+b.Bundles.length+" bundles as prior page swan song"),this.sendSwanSongBundles(b.OrgId,b.UserId,b.SessionId,b.PageId,b.PageStartTime,b.Bundles,b.LastBundleTime))):a.logIfDebug("Malformed swan song found. Ignoring it.")}}catch(g){a.logIfDebug("Error recovering swan-song: "+g)}};b.prototype.sendSwanSongBundles=
function(c,b,g,f,m,e,h,k){var p=this;void 0===k&&(k=0);var r=null;1==e.length&&(r=this._ctx.wallTime()-h);r=this.bundleUrl(c,b,g,f,e[0],m,r);this._ctx.post(this._host,r,e[0],function(k){a.logIfDebug("Sent "+e[0].Evts.length+" trailing events from last session as Seq "+e[0].Seq);e.shift();0<e.length?p.sendSwanSongBundles(c,b,g,f,m,e,h):a.logIfDebug("Done with prior page swan song")},function(r){p.isErrorFatal(r)?a.logIfDebug("Fatal error while sending events, giving up"):(a.logIfDebug("Failed to send events from last session, will retry while on this page"),
p._lastSwanSongRetryTicker=p.createTicker(p.exponentialBackoffMs(k,!0)),p._lastSwanSongRetryTicker.oneShot(function(){p.sendSwanSongBundles(c,b,g,f,m,e,h,k+1)}))})};b.prototype.rebaseIframe=function(c,b){var g=this._ctx.baseUri();0<this._eventQueue.length?this._eventQueue.unshift({When:this._eventQueue[0].When,Kind:a.EVENT_SET_FRAME_BASE,Args:[g,b]}):this.enqueue(a.EVENT_SET_FRAME_BASE,[g,b]);for(var g=0,f=this._eventQueue.length;g<f;g++){var e=this._eventQueue[g],h=e.When+this._ctx.startTime()-c;
0>h&&(h=0);e.When=h}};b.prototype.processEvents=function(c){this._beforeProcessEvents();this._ctx.now()-this._lastUserAction>a.UserInactivityTimeout?this._quiescent||(this._quiescent=!0,this._heartbeatInterval=a.HeartbeatInitial,this._lastHeartbeat=this._ctx.now()):this._quiescent=!1;if((!this._quiescent||this.maybeSendHeartbeat())&&(this._eventQueue.length||this._mutProvider.hasMutations())&&null!=this._ctx.frameId()){var b=this._eventQueue;this._eventQueue=[];b=this._processor.processQueue(b);c||
(b=b.concat(this._mutProvider.processMutations()));this.ensureFrameIds(b);this._ctx.amInsideIFrame()?this._ctx.postEventsToParent(b):void 0!==this._ctx.pageId()&&(this._outgoingEventQueue=this._outgoingEventQueue.concat(b))}};b.prototype.maybeSendHeartbeat=function(){var c=this._ctx.now();return c-this._lastHeartbeat>=this._heartbeatInterval?(this._lastHeartbeat=c,this._heartbeatInterval*=2,this._heartbeatInterval>a.HeartbeatMax&&(this._heartbeatInterval=a.HeartbeatMax),this.enqueue(a.EVENT_HEARTBEAT,
[]),!0):!1};b.prototype.ensureFrameIds=function(a){var b=this._ctx.frameId();if(b)for(var g=this._ctx.parentIds(),f=g&&0<g.length,e=0;e<a.length;++e){var h=a[e];h.FId||(h.FId=b);f&&!h.PIds&&(h.PIds=g)}};b.prototype.enqueueAndSendBundle=function(){this._pendingBundle?this._pendingBundleFailed&&this._sendPendingBundle():0==this._outgoingEventQueue.length?this.maybeSendNextBundle():this.enqueueNextBundle()};b.prototype.enqueueNextBundle=function(){var a={When:this._outgoingEventQueue[0].When,Seq:this._bundleSeq++,
Evts:this._outgoingEventQueue};this._outgoingEventQueue=[];this._bundleQueue.push(a);this.maybeSendNextBundle()};b.prototype.maybeSendNextBundle=function(){this._ctx.pageId()&&(!this._pendingBundle&&0!=this._bundleQueue.length)&&(this._pendingBundle=this._bundleQueue.shift(),this._sendPendingBundle())};b.prototype.bundleUrl=function(a,b,g,f,e,h,l){a="/rec/bundle?OrgId="+a+"&UserId="+b+"&SessionId="+g+"&PageId="+f+"&Seq="+e.Seq;h&&(a+="&PageStartTime="+h);l&&(a+="&DeltaT="+l);return a};b.prototype._sendPendingBundle=
function(){var b=this,d=this._ctx.wallTime();if(!(d<this._backoffTime)){var g=this._pendingBundle;this._pendingBundleFailed=!1;var f=this.bundleUrl(this._ctx.orgId(),this._ctx.userId(),this._ctx.sessionId(),this._ctx.pageId(),g);this._lastPostTime=this._lastBundleTime=d;this._lastWhenTime=g.Evts[g.Evts.length-1].When;this._ctx.post(this._host,f,g,function(d){a.logIfDebug("Sent bundle "+g.Seq+" with "+g.Evts.length+" events");b._pendingBundle=null;b._backoffTime=0;b._backoffRetries=0;b._ctx.wallTime()-
b._lastPostTime>a.UploadInterval&&b.maybeSendNextBundle()},function(d){a.logIfDebug("Failed to send events.");b.isErrorFatal(d)?b.stopPipeline():(b._pendingBundleFailed=!0,b._backoffTime=b._lastPostTime+b.exponentialBackoffMs(b._backoffRetries++,!1))})}};b.prototype.stopPipeline=function(){this._pipelineStarted&&(this._sampleCurvesTicker.stop(),this._processMutationsTicker.stop(),this._uploadTicker.stop(),this._eventQueue=[],this._outgoingEventQueue=[],this._bundleQueue=[])};return b}();a.EventQueue=
e})(k||(k={}));(function(a){var h=function(){function e(b,c,d){void 0===d&&(d=function(a,b){});this._ctx=b;this._blocker=c;this._visitor=d;this._sentDomSnapshot=!1;this._records=[];this._lz=new a.LZJGWEncoder;this._encoder=new a.NodeEncoder(b,c)}e.prototype.hasMutations=function(){return!this._sentDomSnapshot||0<this._records.length};e.prototype.hookMutations=function(a){var c=this;void 0===a&&(a=document.documentElement);this._root=a;this._sentDomSnapshot=!1;(new window.MutationObserver(function(a){c._records=
c._records.concat(a)})).observe(a,{childList:!0,attributes:!0,characterData:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0})};e.prototype.processMutations=function(){var b=this._ctx.now(),c=[];this._sentDomSnapshot||(this.genInsert(b,c,null,this._root,null),this._sentDomSnapshot=!0);if(0==this._records.length)return c;var d={},g={};this.processRecords(b,c,g,d);for(var f in g){var e=f.split(":");c.push({Kind:a.EVENT_MUT_ATTR,When:b,Args:[parseInt(e[0]),e[1],g[f]]})}for(f in d)c.push({Kind:a.EVENT_MUT_TEXT,
When:b,Args:[parseInt(f),d[f]]});this._records=[];return c};e.prototype.processRecords=function(b,c,d,g){for(var f={},e={},h=0;h<this._records.length;++h)try{var l=this._records[h],k=a.fsid(l.target);if(k)switch(f[k]=l.target,l.type){case "childList":if(0<l.removedNodes.length)for(var p=0;p<l.removedNodes.length;++p){var r=a.mirrorFor(l.removedNodes[p]);r&&r.id&&r.parent==a.mirrorFor(l.target)&&r.next==a.mirrorFor(l.nextSibling)&&this.genRemove(b,c,r)}k&&(e[k]=l.target);break;case "characterData":var t=
l.target.textContent;l.oldValue!=t&&(a.isBlocked(l.target)||(g[k]=t));break;case "attributes":var w=l.attributeName;l.target.hasAttribute(w)?(t=l.target.getAttribute(w),l.oldValue!=t&&(t=this.rewriteAttr(l.target,w,t),null!==t&&(d[k+":"+w]=t))):d[k+":"+w]=null}}catch(s){}for(var A in e)d=e[A],(g=a.mirrorFor(d))&&g.id&&this.diff(b,c,d,g.child,d.firstChild);for(A in f)d=f[A],this.maybeAddPlaceholderResize(b,c,d)};e.prototype.diff=function(b,c,d,g,f){for(;g&&f;){var e=a.mirrorFor(f);a.fsid(f)?g.id==
e.id?(g=g.next,f=f.nextSibling):(this.genRemove(b,c,g),g=g.next):(this.genInsert(b,c,d,f,g.node),f=f.nextSibling)}for(;g;g=g.next)this.genRemove(b,c,g);for(;f;f=f.nextSibling)this.genInsert(b,c,d,f,null)};e.prototype.maybeAddPlaceholderResize=function(b,c,d){try{for(;d&&!a.fsid(d);)d=d.parentNode;if(d&&a.isBlocked(d)){var g=d.getBoundingClientRect(),f=Math.floor(g.width),e=Math.floor(g.height);c.push({When:b,Kind:a.EVENT_PLACEHOLDER_SIZE,Args:[a.fsid(d),f,e]})}}catch(h){}};e.prototype.genInsert=function(b,
c,d,g,f){var e=this;if(d&&a.isBlocked(d))return null;g=this._encoder.tokenizeNode(d,f,g,function(a){e._visitor(b,a)});0<g.length&&c.push({When:b,Kind:a.EVENT_MUT_INSERT,Args:[a.fsid(d)||-1,a.fsid(f)||-1,this._lz.encode(g)]})};e.prototype.genRemove=function(b,c,d){var g=d.id;this._encoder.removeMirror(d);if(0<c.length&&(d=c[c.length-1],d.Kind==a.EVENT_MUT_REMOVE)){d.Args.push(g);return}c.push({When:b,Kind:a.EVENT_MUT_REMOVE,Args:[g]})};e.prototype.rewriteAttr=function(b,c,d){switch(c){case "style":a.isBlocked(b)&&
(d=this._blocker.mungeBlockedStyle(b,d));break;case "class":a.isBlocked(b)&&0>d.indexOf("_fs_block_")&&(b=a.blockKind(b),d+=" _fs_block_"+b);break;case "value":a.isBlocked(b)&&(d=null)}return d};return e}();a.MutationHandler=h})(k||(k={}));(function(a){var h=function(){function a(b,d,g){this._ctx=b;this._q=d;this._valueIndices=g;this._evts=[]}a.prototype.add=function(a){0==this._evts.length&&this._q.push(a);this._evts.push(a)};a.prototype.finish=function(a,b){var g=this._evts.length;if(1>=g)return!1;
for(var f=this._evts[0].When,e=this._evts[g-1].When,h=0;h<this._valueIndices.length;++h){var k=this._valueIndices[h],u=this._evts[0].Args[k],p=(this._evts[1].When-f)/(e-f),r=(this._evts[1].Args[k]-u)/p,t=this._evts[g-1].Args[k],p=(e-this._evts[g-2].When)/(e-f);b.push(u,t,r,(t-this._evts[g-2].Args[k])/p)}this._evts[0].Kind=a;this._evts[0].Args=b;return!0};a.prototype.evts=function(){return this._evts};return a}(),e=function(){function b(a,b){this._ctx=a;this._blocker=b;this._gotInitialScroll=!1}b.prototype.processQueue=
function(b){if(0==b.length)return b;this.maybeAddInitialScroll();for(var d=this._ctx.now(),g=[],f=new h(this._ctx,g,[0,1]),e={},k={},l,u=0;u<b.length;++u){var p=b[u];switch(p.Kind){case a.EVENT_MOUSEMOVE:f.add(p);break;case a.EVENT_TOUCHMOVE:var r=p.Args[0];r in e||(e[r]=new h(this._ctx,g,[1,2]));e[r].add(p);break;case a.EVENT_SCROLL:r=p.Args[0];r in k||(k[r]=new h(this._ctx,g,[1,2]));k[r].add(p);break;case a.EVENT_INNERWIDTH:l||(l=new h(this._ctx,g,[0]));l.add(p);break;default:g.push(p)}}f.finish(a.EVENT_MOUSEMOVE_CURVE,
[d])&&(b=f.evts(),f=b[b.length-1].Args,2<f.length&&f[2]&&b[0].Args.push(f[2]));for(r in k)b=parseInt(r),k[b].finish(a.EVENT_SCROLL_CURVE,[d,b]);for(r in e)b=parseInt(r),e[b].finish(a.EVENT_TOUCHMOVE_CURVE,[d,b]);l&&l.finish(a.EVENT_INNERWIDTH_CURVE,[d]);return g};b.prototype.maybeAddInitialScroll=function(){!this._gotInitialScroll&&(document.body&&a.fsid(document.body))&&(this._ctx.addWindowScroll(),this._gotInitialScroll=!0)};return b}();a.EventProcessor=e})(k||(k={}));(function(a){var h=function(){function e(a){this._queue=
a;this._overflow=this._enabled=!1;this._total=0}e.prototype.enable=function(){var b=this;b._enabled||(b._enabled=!0,window.console?(console.log&&console.log.apply&&(b._oldLog=console.log,console.log=a.$entry(function(){b.addLog("log",arguments);return b._oldLog.apply(this,arguments)})),console.info&&console.info.apply&&(b._oldInfo=console.info,console.info=a.$entry(function(){b.addLog("info",arguments);return b._oldInfo.apply(this,arguments)})),console.warn&&console.warn.apply&&(b._oldWarn=console.warn,
console.warn=a.$entry(function(){b.addLog("warn",arguments);return b._oldWarn.apply(this,arguments)})),console.error&&console.error.apply&&(b._oldError=console.error,console.error=a.$entry(function(){b.addLog("error",arguments);return b._oldError.apply(this,arguments)}))):b.addLog("log",["NOTE: Log messages cannot be captured on IE9"]),b._oldOnError=window.onerror,window.onerror=function(a,d,g){b.addError(a,d,g);if(b._oldOnError)return b._oldOnError.apply(this,arguments)})};e.prototype.disable=function(){this._enabled&&
(this._enabled=!1,this._oldLog&&(console.log=this._oldLog),this._oldInfo&&(console.info=this._oldInfo),this._oldWarn&&(console.warn=this._oldWarn),this._oldError&&(console.error=this._oldError),window.onerror=this._oldOnError)};e.prototype.addLog=function(b,c){if(this.checkOverflow()){for(var d=[b],g=0;g<c.length;++g)d.push(a.stringify(c[g]));this._queue.enqueue(a.EVENT_LOG,d)}};e.prototype.addError=function(b,c,d){this.checkOverflow()&&this._queue.enqueue(a.EVENT_ERROR,[b,c,d])};e.prototype.checkOverflow=
function(){if(this._overflow)return!1;if(this._total==a.MAX_LOGS_PER_PAGE)return this._queue.enqueue(a.EVENT_LOG,["warn",e.OVERFLOW_MSG]),this._overflow=!0,!1;this._total++;return!0};e.OVERFLOW_MSG='"[received more than '+a.MAX_LOGS_PER_PAGE+' messages; no longer recording console]"';return e}();a.ConsoleHook=h})(k||(k={}));(function(a){a.UID_COOKIE="fs_uid";a.BAD_APP_IDS=" 0 1 -1 n/a nan undefined null nil the_id_that_you_use_in_your_app_for_this_user".split(" ");var h=function(){function e(){this._cookie=
null;this._cookies={}}e.prototype.initFromCookies=function(b,c,d){d=d.split(";");for(var g=0;g<d.length;g++){var f=d[g].replace(/^\s+|\s+$/g,"").split("=");this._cookies[f[0]]=f[1]}this._cookie=e.parseCookie(this._cookies[a.UID_COOKIE]);if(this._cookie.Host!=b||this._cookie.OrgId!=c)this._cookie={Host:b,OrgId:c,UserId:"",SessionId:"",AppKey:"",Poisoned:!1}};e.prototype.initFromParsedCookie=function(a){this._cookie=a};e.parseCookie=function(b){var c="",d="",g="",f="",e="",h=!1;if(b){var k=b.split("`");
3>k.length?c=b:(g=k[0],f=k[1],c=k[2],5<=k.length&&(e=decodeURIComponent(k[3]),h="true"==k[4],0<=a.BAD_APP_IDS.indexOf(e)&&(a.logIfDebug('ignoring invalid app key "'+e+'" from cookie.'),e="",h=!1)))}b=c.indexOf(":");-1!=b&&(d=c.slice(b+1),c=c.slice(0,b));return{Host:g,OrgId:f,UserId:c,SessionId:d,AppKey:e,Poisoned:h}};e.prototype.host=function(){return this._cookie.Host};e.prototype.orgId=function(){return this._cookie.OrgId};e.prototype.userId=function(){return this._cookie.UserId};e.prototype.sessionId=
function(){return this._cookie.SessionId};e.prototype.appKey=function(){return this._cookie.AppKey};e.prototype.poisoned=function(){return this._cookie.Poisoned};e.prototype.cookieData=function(){return this._cookie};e.prototype.cookies=function(){return this._cookies};e.prototype.setCookie=function(a,c){var d=a+"="+c,d=this._domain?d+("; domain=."+encodeURIComponent(this._domain)):d+"; domain=";document.cookie=d+"; expires=Fri, 31 Dec 9999 23:59:59 GMT; path=/"};e.prototype.setIds=function(a,c,d){if("localhost"==
a||"127.0.0.1"==a)a="";this._domain=a;this._cookie.UserId=c;this._cookie.SessionId=d;this.write()};e.prototype.setAppId=function(b){b&&(b=b.trim());if(!b)return this._cookie.Poisoned?(a.logIfDebug("blocking FS.setUserVars API call due to mismatched user ID"),[!1,void 0]):[!0,void 0];if(b){var c=b.toLowerCase();if(0<=a.BAD_APP_IDS.indexOf(c))return a.logIfDebug("blocking FS.identify API call; uid value ("+b+") is illegal"),[!1,"fsidentity"]}if(this._cookie.AppKey&&this._cookie.AppKey!=b)return a.logIfDebug("blocking FS.identify API call; existing uid ("+
this._cookie.AppKey+") does not match provided uid ("+b+")"),this._cookie.Poisoned=!0,this.write(),[!1,"newuid"];this._cookie.AppKey=b;this._cookie.Poisoned=!1;this.write();return[!0,void 0]};e.prototype.encode=function(){var a=this._cookie.Host+"`"+this._cookie.OrgId+"`"+this._cookie.UserId+":"+this._cookie.SessionId;this._cookie.AppKey&&(a+="`"+encodeURIComponent(this._cookie.AppKey)+"`"+this._cookie.Poisoned);return a};e.prototype.write=function(){null!=this._domain&&this.setCookie(a.UID_COOKIE,
this.encode())};return e}();a.Identity=h})(k||(k={}));(function(a){function h(){return window[e]}var e="_fs_loaded",b;a.Namespace=function(){b||(b=h()?h():window._fs_namespace?window._fs_namespace:"FS");return b};a.isLoaded=h;a.setLoaded=function(a){window[e]=a;a in window||(window[a]={})}})(k||(k={}));(function(a){var h=function(){function e(b,c){var d=this;this._queue=b;this._identity=c;this.AccountSystemVars={acctId:"str",displayName:"str",website:"str"};this.UserSystemVars={uid:"str",displayName:"str",
email:"str"};this.VarTypes={str:function(a){return"string"==typeof a},bool:function(a){return"boolean"==typeof a},"int":function(a){return"number"==typeof a&&0==a-Math.floor(a)},real:function(a){return"number"==typeof a},date:function(a){return a?!isNaN(a.constructor===Date?a:new Date(a)):!1}};this._apiImpl=a.$entry(function(b,c){switch(b){case "account":if(d._identity.poisoned()){a.logIfDebug("blocking FS.identifyAccount API call due to mismatched user ID");break}d.setvar_api("acct",d.AccountSystemVars,
c);break;case "user":var e=d._identity.setAppId(c.uid),h=e[1];if(!e[0]){switch(h){case "newuid":d._queue.enqueue(a.EVENT_SYS_HIGHLIGHT,["newuid",c.uid,d._identity.appKey()]);break;case "fsidentity":d._queue.enqueue(a.EVENT_SYS_HIGHLIGHT,["fsidentity",c.uid]);break;case void 0:break;default:a.logIfDebug("unexpected failReason returned from setAppId: "+h)}break}d.setvar_api("user",d.UserSystemVars,c);break;default:a.logIfDebug('invalid operation "'+b+'"; only "account" and "user" are supported at present')}})}
e.prototype.api=function(a,c){this._apiImpl(a,c)};e.prototype.processApiQueue=function(a){if(a)for(var c=0;c<a.length;c++)this.api(a[c][0],a[c][1])};e.prototype.setvar_api=function(b,c,d){var e={},f;for(f in d)if(d.hasOwnProperty(f)){var h=d[f];a.logIfDebug("set-var('"+b+"'): \""+f+'" = '+a.stringify(h));var k=typeof h;if("object"!==k||h&&h.constructor==Date){var l,u;if(f in c)l=f,u=c[f];else{u=f.split("_");if(2!=u.length){a.logIfDebug('variables must be of the form "name_type", where "type" is one of [str, bool, int, real, date]');
this._queue.enqueue(a.EVENT_SYS_HIGHLIGHT,["varname",b+":"+f]);continue}-1!=f.indexOf(" ")?(l=f.replace(/ /g,""),this._queue.enqueue(a.EVENT_SYS_HIGHLIGHT,["varname",b+":"+f]),a.logIfDebug("Warning: variable '"+f+"' has spaces in it, which is disallowed. Converted name to '"+l+"'.")):l=f;u=u[1]}u in this.VarTypes?this.VarTypes[u](h)?("str"==u&&(h=(h=/\b.*\b/g.exec(h))?h[0]:""),"date"==u&&(h=this.toIsoString(h)),e[l]=h):(a.logIfDebug("illegal value "+a.stringify(h)+" for type "+u),"number"===k?k=0==
h-Math.floor(h)?"integer":"real":"object"==k&&(null!=h&&h.constructor==Date)&&(k=isNaN(h)?"invalid date":"date"),this._queue.enqueue(a.EVENT_SYS_HIGHLIGHT,["vartype",b+":"+f,k])):(a.logIfDebug('invalid type "'+u+'"'),this._queue.enqueue(a.EVENT_SYS_HIGHLIGHT,["varname",b+":"+f]))}else h instanceof Array&&(k="array"),this._queue.enqueue(a.EVENT_SYS_HIGHLIGHT,["vartype",b+":"+f,k+" (unsupported)"])}this._queue.enqueue(a.EVENT_SYS_SETVAR,[b,a.stringify(e)])};e.prototype.toIsoString=function(a){return(a.constructor===
Date?a:new Date(a)).toISOString()};return e}();a.Vars=h})(k||(k={}));(function(a){function h(b,c){void 0===c&&(c=null);window._fs_transport?window._fs_transport.send(b,a.stringify(c)):parent.postMessage(a.stringify({__fs:[b,c?c:""]}),"*")}function e(b,c,d,e,g){void 0===g&&(g=null);b||(b=v.host());b="//"+b+c;c=null;null!=d&&(c=a.stringify(d),N+=c.length,a.logIfDebug("total bytes written: "+N));var f=new XMLHttpRequest;if("withCredentials"in f)f.onreadystatechange=function(){f.readyState==a.XHR_DONE&&
(200==f.status?e(f.responseText):g(f.status))},f.open("POST",G+b,!0),f.withCredentials=!0,f.setRequestHeader("Content-Type","text/plain"),f.send(c);else{var h=new XDomainRequest;h.onload=function(){e(h.responseText)};h.onerror=function(){g("Not Found"==h.responseText?404:500)};h.onprogress=function(){};h.open("POST",b);h.send(c)}}function b(){if("baseURI"in document)return document.baseURI;var a=document.getElementsByTagName("base")[0];return a&&a.href?a.href:location.href}function c(a){(a=a.target.tagName)&&
(a=a.toLowerCase());return a}function d(a,b){return a.tagName&&a.tagName.toLowerCase()in b?!0:a.parentNode?d(a.parentNode,b):!1}function g(a,b){if(void 0!==a.changedTouches)for(var c=0;c<a.changedTouches.length;++c){var d=a.changedTouches[c];isNaN(parseInt(d.identifier))&&(d.identifier=0);n.enqueue(b,[d.identifier,d.clientX,d.clientY])}}function f(){var a=document.activeElement;a&&H.invokeGlobalOnChange(a)}function k(){var b=window.innerWidth;b!=Z&&(n.enqueue(a.EVENT_INNERWIDTH,[b]),Z=b)}function q(b,
c){b in O||(O[b]=setTimeout(function(){delete O[b];c()},a.ScrollSampleInterval))}function l(){var b=a.fsid(document.body);b&&q(b,function(){var c,d;"pageXOffset"in window?(c=window.pageXOffset,d=window.pageYOffset):(c=document.body.scrollLeft,d=document.body.scrollTop);if(c!=$||d!=aa)n.enqueue(a.EVENT_SCROLL,[b,c,d]),$=c,aa=d;k()})}function u(b){var c=b.target,d=a.fsid(c);d&&q(d,function(){n.enqueue(a.EVENT_SCROLL,[d,c.scrollLeft,c.scrollTop])})}function p(){ba?n.enqueue(a.EVENT_RESIZE,[document.body.clientWidth,
document.body.clientHeight]):n.enqueue(a.EVENT_RESIZE,[document.documentElement.clientWidth,document.documentElement.clientHeight])}function r(){var b=location.href;P!=b&&(P=b,n.enqueue(a.EVENT_NAVIGATE,[location.href,document.title]))}function t(b){var c=a.fsidIfNotBlocked(b);c&&n.enqueue(a.EVENT_VALUECHANGE,[c,a.valueOfInputishElem(b)])}function w(a){if(I&&a){var b=document.createElement("script");b.text=a;b.async=!0;document.head.appendChild(b)}}function s(b){v.setIds(b.CookieDomain,b.UserIntId,
b.SessionIntId);Q=b.PageIntId;ca=b.EmbedToken;a.logIfDebug("/User,"+v.userId()+"/Session,"+v.sessionId()+"/Page,"+Q);n.setHost(b.BundleDomain);da=b.IntegrationScript;w(b.IntegrationScript)}function A(){var a=document.doctype;if(!a)return null;var b;b="<!DOCTYPE "+a.name;a.publicId&&(b+=' PUBLIC "'+a.publicId+'"');a.systemId&&(b+=' "'+a.systemId+'"');return b+">"}function B(){var c=document.documentElement,d=window._fs_hash,f=window._fs_replay_flags;P=location.href;if(J)c={OrgId:v.orgId(),UserId:v.userId(),
Url:location.href,Base:b(),ScreenWidth:window.screen.width,ScreenHeight:window.screen.height,Width:c.clientWidth,Height:c.clientHeight,Referrer:document.referrer,Doctype:A(),Hash:d},f&&(c.ReplayFlags=f),e("","/rec/page",c,function(b){var c;try{c=a.parseJson(b)}catch(d){V();return}s(c);if(window._fs_ready)try{window._fs_ready()}catch(e){a.logIfDebug("exception in _fs_ready(): "+e)}for(b=0;b<c.Blocks.length;++b)try{a.BlockRule.isComment(c.Blocks[b].Selector)||y.addRule(c.Blocks[b])}catch(f){a.logIfDebug("Unexpected error parsing block rule. Skipping "+
c.Blocks[b])}n.startPipeline()},function(a){V()});else{a.logIfDebug("Unable to record playback stream.");var g=document.createElement("script");window.__fs_startResponse=function(a){s(a);document.body.removeChild(g)};g.src="//"+v.host()+"/rec/page?OrgId="+v.orgId()+"&UserId="+v.userId()+"&Url="+encodeURIComponent(location.href)+"&Base="+encodeURIComponent(b())+"&ScreenWidth="+window.screen.width+"&ScreenHeight="+window.screen.height+"&Width="+c.clientWidth+"&Height="+c.clientHeight+"&Referrer="+encodeURIComponent(document.referrer)+
"&Doctype="+encodeURIComponent(A())+"&Fallback=true"+(f?"&ReplayFlags="+f:"")+(d?"&Hash="+d:"");document.body.appendChild(g)}}function V(){n.disableRecording();ea();a.logIfDebug("Disabling FS.");if(window._fs_ready)try{window._fs_ready(!0)}catch(b){a.logIfDebug("exception in _fs_ready(): "+b)}}function qa(){fa.hookMutations();document.documentElement.addEventListener("scroll",function(a){u(a)},!0);window.addEventListener("mousemove",function(b){b=a.fsid(b.target)?[b.clientX,b.clientY,a.fsid(b.target)]:
[b.clientX,b.clientY];n.enqueue(a.EVENT_MOUSEMOVE,b)},!0);window.addEventListener("mousedown",function(b){n.enqueue(a.EVENT_MOUSEDOWN,[b.clientX,b.clientY]);!d(b.target,{button:!0,a:!0,input:!0})||"input"==c(b)&&"submit"!=b.target.type||n.swanSong()},!0);window.addEventListener("mouseup",function(b){n.enqueue(a.EVENT_MOUSEUP,[b.clientX,b.clientY])},!0);window.addEventListener("keydown",function(b){var d=document.activeElement;if(!d||a.fsidIfNotBlocked(d))f(),n.enqueue(a.EVENT_KEYDOWN,[b.keyCode]);
switch(c(b)){case "button":13!=b.keyCode&&32!=b.keyCode||n.swanSong();break;case "a":13==b.keyCode&&n.swanSong();break;case "input":"submit"==b.target.type&&13==b.keyCode&&n.swanSong()}},!0);window.addEventListener("keyup",function(b){var c=document.activeElement;if(!c||a.fsidIfNotBlocked(c))f(),n.enqueue(a.EVENT_KEYUP,[b.keyCode])},!0);window.addEventListener("scroll",function(a){l()});window.addEventListener("resize",function(a){p()});window.addEventListener("submit",function(b){(b=a.fsid(b.target))&&
n.enqueue(a.EVENT_FORM_SUBMIT,[b])});document.body.addEventListener("click",function(b){(b=a.fsid(b.target))&&n.enqueue(a.EVENT_CLICK,[b])},!0);document.body.addEventListener("dblclick",function(b){(b=a.fsid(b.target))&&n.enqueue(a.EVENT_DBL_CLICK,[b])},!0);document.body.addEventListener("focus",function(b){(b=a.fsid(b.target))&&n.enqueue(a.EVENT_FOCUS,[b])},!0);document.body.addEventListener("blur",function(b){(b=a.fsid(b.target))&&n.enqueue(a.EVENT_BLUR,[b])},!0);document.body.addEventListener("change",
function(a){t(a.target)},!0);window.addEventListener("touchstart",function(b){g(b,a.EVENT_TOUCHSTART);l()},!0);window.addEventListener("touchend",function(b){g(b,a.EVENT_TOUCHEND);l()},!0);window.addEventListener("touchmove",function(b){g(b,a.EVENT_TOUCHMOVE);l()},!0);window.addEventListener("touchcancel",function(b){g(b,a.EVENT_TOUCHCANCEL)},!0);window.addEventListener("play",function(b){var c=a.EVENT_PLAY;(b=a.fsid(b.target))&&n.enqueue(c,[b])},!0);window.addEventListener("pause",function(b){var c=
a.EVENT_PAUSE;(b=a.fsid(b.target))&&n.enqueue(c,[b])},!0);window.addEventListener("focus",function(b){n.enqueue(a.EVENT_WINDOW_FOCUS,[])},!1);window.addEventListener("blur",function(b){n.enqueue(a.EVENT_WINDOW_BLUR,[])},!1);H.hookEvents();if(history.pushState){window.addEventListener("popstate",function(){r()});var b=history.pushState;history.pushState=function(a,c,d){b.call(this,a,c,d);r()};var e=history.replaceState;history.replaceState=function(a,b,c){e.call(this,a,b,c);r()}}}function M(){R.enable()}
function W(){R.disable()}function X(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];"log"!==a&&("info"!==a&&"warn"!==a&&"error"!==a&&"debug"!==a)&&(b.unshift(a),a="log");R.addLog(a,b)}function Y(){"_fs_ext_debug"in window?K=!!window._fs_ext_debug:"_fs_debug"in window&&(K=!!window._fs_debug);if("_fs_host"in window||"_fs_ext_host"in window)if("_fs_org"in window||"_fs_ext_org"in window){var b=window._fs_ext_host||window._fs_host,c=window._fs_ext_org||window._fs_org;"localhost:8080"==b&&
(G="http:");a.logIfDebug("host: "+b);a.logIfDebug("orgid: "+c);M();ba="BackCompat"==document.compatMode;if(window._fs_is_outer_script)z=!1;else if(window!=top)z=!0;else{var d=window._fs_transport;z=d&&d.init&&d.init(c)?!0:!1}x=z?null:0;v=new a.Identity;S=new a.Vars(n,v);J=!!window.MutationEvent;z?window._fs_run_in_iframe||window._fs_transport?parent.postMessage?ra():(J=!1,a.logIfDebug("postMessage not supported")):a.logIfDebug("Fullstory recording for this page is NOT allowed within an iFrame."):
(v.initFromCookies(b,c,document.cookie),y.addRule({Selector:"object",Kind:a.NYI_KIND}),y.addRule({Selector:"embed",Kind:a.NYI_KIND}),y.addRule({Selector:"canvas",Kind:a.NYI_KIND}),y.addRule({Selector:"noscript",Kind:a.BLOCKED_KIND}),y.addRule({Selector:".fs-hide",Kind:a.HIDE_KIND}),S.processApiQueue(window[a.Namespace()].q),delete window[a.Namespace()].q,B())}else a.logIfDebug("Missing global _fs_org. Recording disabled.");else a.logIfDebug("Missing global _fs_host. Recording disabled.")}function D(){return(new Date).getTime()}
function sa(){var b=function(){I||(I=!0,n.enqueue(a.EVENT_DOMLOADED,[]),qa(),p(),w(da))},c=!1,d=function(){c||(c=!0,n.enqueue(a.EVENT_LOAD,[]))};switch(document.readyState){case "interactive":document.attachEvent||b();break;case "complete":b(),d()}I||document.addEventListener("DOMContentLoaded",function(a){b()});c||window.addEventListener("load",function(a){b();d()});z||(window.addEventListener("beforeunload",function(a){n.addUnload()}),window.addEventListener("unload",function(a){n.addUnload()}))}
function ga(){J&&(n.recoverSwanSong(),E=D(),sa())}function ha(a,b){S.api(a,b)}function ia(b,c,d){b&&"string"==typeof b?c&&"string"!=typeof c?a.logIfDebug("setUid(): second argument (display name) must be a string"):(c||(c=b),d&&"object"!=typeof d?a.logIfDebug('setUid(): third argument (metadata) must be of the form {name0: "value0", name1: "value1", ...}'):(d=d?a.stringify(d):"",a.logIfDebug("setting uid: "+b+", meta: "+d),n.enqueue(a.EVENT_SYS_SETMETA,[b,c,d]))):a.logIfDebug("setUid(): first argument (user id) is required and must be a string")}
function ja(a){var b=T();if(!b)return null;a&&(b+=":"+D());return G+"//"+v.host()+"/ui/"+v.orgId()+"/session/"+encodeURIComponent(b)}function T(){return v.userId()?v.userId()+":"+v.sessionId():null}function ka(){return v.cookies()}function la(a,b){return v.setCookie(a,b)}function ra(){window.addEventListener("message",function(b){if("string"==typeof b.data){var c=ma(b.data);if(c[0]==a.FS_SET_FRAME_ID_CMD)try{var d=c[1],e=c[2],f=c[3],g=c[4],h=c[5];if(d)if(x)a.logIfDebug("frame Id is already set to "+
x+". Received second request to set it to "+d+" Iframe:"+location.href);else{a.logIfDebug("FrameId received within frame "+location.href+": "+d);v.initFromParsedCookie(h);x=d;L=e;for(c=0;c<g.length;++c)y.addRule(g[c]);n.rebaseIframe(f,A());E=f;n.startPipeline();if(0<F.length){for(c=0;c<F.length;c++)F[c]();F=[]}}else a.logIfDebug("Outer page gave us a bogus frame Id! Iframe: "+location.href)}catch(k){a.logIfDebug("Failed to parse frameId from message"+b.data)}else c[0]==a.FS_DISABLE_RECORDING?(n.disableRecording(),
ea()):b.source==parent&&a.logIfDebug("Invalid _fs postmessage command: "+c[0])}});x||(0==x?a.logIfDebug("For some reason the outer window attempted to request a frameId"):(a.logIfDebug("Asking for a frame ID from within frame: "+location.href),h(a.FS_REQUEST_FRAME_ID)))}function ma(b){try{var c=a.parseJson(b);if("__fs"in c)return c.__fs}catch(d){}return[]}function ea(){for(var b=0;b<C.length;b++){var c=C[b];c.contentWindow&&c.contentWindow.postMessage&&c.contentWindow.postMessage(a.stringify({__fs:[a.FS_DISABLE_RECORDING]}),
"*")}}function ta(){window.addEventListener("message",function(b){if("string"==typeof b.data){var c=ma(b.data);if(c[0]==a.FS_IFRAME_EVENTS)b=c[1],0<b.length&&(z?n.appendToQueue(b):n.appendToOutgoingQueue(b));else{var d;a:{d=b.source;for(var e=0;e<C.length;e++)if(C[e].contentWindow==d){d=a.fsid(C[e]);break a}a.logIfDebug("Unable to locate frame for window");d=NaN}c[0]==a.FS_REQUEST_FRAME_ID?b.source&&d?(a.logIfDebug("Responding to FID request for frame "+d),na(b.source,d)):a.logIfDebug("No FrameId found. Hoping to send one later."):
z||a.logIfDebug("Invalid _fs postmessage command: "+c[0]+" sent from child FrameId: "+d)}}})}function na(b,c){var d=function(){var d=[];0!=x&&(d=L?L.concat(x):[x]);b.postMessage(a.stringify({__fs:[a.FS_SET_FRAME_ID_CMD,c,d,E,y.rawRules,v.cookieData()]}),"*")};null==x?F.push(d):d()}function oa(b){a.logIfDebug("Injecting into Frame ["+b.src+"]");try{if(b.src&&("about:blank"!=b.src&&0>b.src.indexOf("javascript:"))&&b.src!=b.contentWindow.location.href)a.logIfDebug("Frame not yet loaded: "+b.src);else if(b.contentWindow[a.Namespace()])a.logIfDebug("FS already defined in Frame contentWindow: "+
b.src+". Ignoring.");else{var c=b.contentDocument,d="var _fs_org='"+v.orgId()+"', _fs_host='"+v.host()+"', _fs_run_in_iframe=true, _fs_debug="+K+"; (function(w,a,t){a=w.createElement('script');a.async=1;a.src='"+G+"//'+_fs_host+'/s/fs.js';w.head.appendChild(a)})(document);",e=c.createElement("script");e.textContent=d;c.head.appendChild(e)}}catch(f){a.logIfDebug("iFrame no injecty. Probably not same origin.")}}function ua(b,c){C.push(c);va(c)?(a.logIfDebug("Attempting to setup Frame ["+c.src+"]"),
oa(c),c.addEventListener("load",function(b){a.logIfDebug("onload for frame ["+c.src+"]");oa(c)})):(a.logIfDebug("Frame Doesn't need injecting. Probably cross domain ["+c.src+"]"),c.contentWindow.postMessage&&(a.logIfDebug("Eagerly sending FrameId "+b+" to Frame ["+c.src+"]"),na(c.contentWindow,b)))}function va(a){var b=a.src;return!a.hasAttribute("src")||"about:blank"==b||0==b.indexOf("javascript:")||0==b.indexOf(wa)}a.Setup=function(){if(!a.isLoaded()){var b=a.Namespace();a.setLoaded(b);window[b].setUid=
a.$entry(ia);window[b].getCurrentSessionURL=a.$entry(ja);window[b].getCurrentSession=a.$entry(T);window[b].enableConsole=a.$entry(M);window[b].disableConsole=a.$entry(W);window[b].log=a.$entry(X);window[b]._api=ha;window[b]._cookies=ka;window[b]._setCookie=la;Y();ga()}};var K=!1,N=0,Q,x,L,wa=window.location.protocol+"//"+window.location.host,z,J,E=D(),P,I=!1,da=null,pa,$=-1,aa=-1,Z=0,O={},ca,ba=!1,G="https:",U={startTime:function(){return E},now:function(){return D()-E},wallTime:D,orgId:function(){return v.orgId()},
userId:function(){return v.userId()},sessionId:function(){return v.sessionId()},pageId:function(){return Q},baseUri:b,frameId:function(){return x},parentIds:function(){return L},amInsideIFrame:function(){return z},postEventsToParent:function(b){h(a.FS_IFRAME_EVENTS,b)},post:e,addWindowScroll:l},y=new a.Blocker,H=new a.InputWatcher(function(a){t(a)},function(b){return!!a.fsid(b)}),fa=new a.MutationHandler(U,y,function(b,c){switch(c.nodeName){case "INPUT":case "TEXTAREA":case "SELECT":H.addInput(c);
break;case "FRAME":case "IFRAME":var d=a.fsid(c);if(!d){a.logIfDebug("fsid missing or invalid for iFrame."+c.src);break}pa||(ta(),pa=!0);ua(d,c);break;case "VIDEO":case "AUDIO":c.paused||(d=a.fsid(c),n.enqueue(a.EVENT_PLAY,[d]))}}),xa=new a.EventProcessor(U,y),n=new a.EventQueue(U,xa,fa,function(){H.tick();k()}),R=new a.ConsoleHook(n),v,S;window._fs_shutdown=function(a){n.shutdown();a&&(a=document.getElementById(a))&&a.setAttribute("_fs_embed_token",ca)};a.enableConsole=M;a.disableConsole=W;a.log=
X;a._init=Y;a._record=ga;a.isDebug=function(){return K};a._api=ha;a.setUid=ia;a.getCurrentSessionURL=ja;a.getCurrentSession=T;a._cookies=ka;a._setCookie=la;a.FS_REQUEST_FRAME_ID="RequestFrameId";a.FS_SET_FRAME_ID_CMD="SetFrameId";a.FS_IFRAME_EVENTS="EvtBundle";a.FS_DISABLE_RECORDING="DisableRecording";var C=[],F=[]})(k||(k={}));try{k.Setup()}catch(B){window._fs_debug&&window.console&&console.log&&console.log("Failed to initialize FullStory.")}})();
